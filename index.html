<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DARKLENS ‚Äì Explorador de Personalidad</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.11.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    .hidden {
      display: none;
    }

    .analisis-loading {
      font-weight: bold;
      color: #c080ff;
      margin-top: 10px;
      text-align: center;
      font-size: 1.1em;
      padding: 20px;
      background: rgba(127, 0, 255, 0.1);
      border-radius: 10px;
    }

    .resultado-box {
      border: 2px solid #6c63ff;
      padding: 20px;
      border-radius: 10px;
      background-color: rgba(249, 249, 255, 0.9);
      margin-top: 20px;
    }

    .emocion-bar {
      margin-bottom: 10px;
      background-color: #eee;
      border-radius: 5px;
      overflow: hidden;
      position: relative;
      height: 30px;
    }

    .emocion-bar-fill {
      background-color: #6c63ff;
      height: 100%;
      position: absolute;
      top: 0;
      left: 0;
      transition: width 0.5s ease;
    }

    .emocion-bar-content {
      position: relative;
      z-index: 1;
      display: flex;
      justify-content: space-between;
      padding: 5px 10px;
      font-size: 0.95em;
      color: #333;
    }

    /* Estilos para la p√°gina de resultados integrados */
    .resultado-integrado {
      max-width: 1200px;
      margin: 0 auto;
    }

    .audio-controls {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-bottom: 30px;
      flex-wrap: wrap;
    }

    .btn-audio {
      padding: 12px 25px;
      font-size: 1em;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 25px;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
      font-weight: 600;
    }

    .btn-audio:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
    }

    .btn-audio:active {
      transform: translateY(0);
    }

    .perfiles-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .grafico-emociones-container {
      margin: 30px 0;
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    .grafico-emociones-container canvas {
      max-height: 400px;
    }

    .narrativa-principal {
      background: linear-gradient(135deg, rgba(249, 249, 255, 0.9) 0%, rgba(230, 230, 255, 0.9) 100%);
      font-size: 1.05em;
      line-height: 1.8;
    }

    .narrativa-principal p {
      margin-bottom: 15px;
    }

    .disclaimer {
      background: rgba(255, 200, 200, 0.2);
      border-color: #ff6384;
    }

    .footer-investigacion {
      text-align: center;
      margin-top: 40px;
      padding-top: 30px;
      border-top: 2px solid rgba(127, 0, 255, 0.2);
    }

    .btn-primary {
      padding: 15px 40px;
      font-size: 1.1em;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 30px;
      cursor: pointer;
      transition: all 0.3s;
      font-weight: 600;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
    }

    .btn-primary:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
    }

    .btn-primary:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    #input-imagen {
      display: none;
    }

    .test-item {
      margin-bottom: 25px;
      padding: 20px;
      background: rgba(255, 255, 255, 0.5);
      border-radius: 10px;
      transition: background 0.3s;
    }

    .test-item:hover {
      background: rgba(255, 255, 255, 0.8);
    }

    .opciones {
      display: flex;
      gap: 10px;
      margin-top: 10px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .opciones input[type="radio"] {
      display: none;
    }

    .opciones label {
      padding: 10px 20px;
      border: 2px solid #6c63ff;
      border-radius: 5px;
      cursor: pointer;
      transition: all 0.3s;
      background: white;
      min-width: 50px;
      text-align: center;
    }

    .opciones input[type="radio"]:checked + label {
      background: #6c63ff;
      color: white;
      transform: scale(1.1);
    }

    .opciones label:hover {
      background: rgba(108, 99, 255, 0.2);
    }
  </style>
</head>
<body>

  <!-- HERO -->
  <section class="hero">
    <img src="assets/futuristic_face.png" alt="An√°lisis facial futurista" class="hero-img">
  </section>

  <!-- BIENVENIDA -->
  <div class="container">
    <section class="bienvenida" id="seccion-bienvenida">
      <h1>DARKLENS</h1>
      <h2>Explorador de rasgos de personalidad oscura mediante test psicom√©trico y an√°lisis de microexpresiones</h2>

      <div class="explicacion">
        <h3>¬øEn qu√© consiste esta experiencia?</h3>
        <p>
          DARKLENS es una herramienta experimental dise√±ada para explorar rasgos de personalidad oscura mediante la integraci√≥n de dos enfoques complementarios: la evaluaci√≥n psicom√©trica y el an√°lisis automatizado de microexpresiones faciales. Esta experiencia forma parte de una investigaci√≥n acad√©mica en el marco de la <strong>Licenciatura en Ciencia de Datos</strong> de la <strong>Universidad del Gran Rosario (UGR)</strong>.
        </p>
        <p>La participaci√≥n es voluntaria, an√≥nima y no implica ning√∫n tipo de diagn√≥stico cl√≠nico. El objetivo es ofrecer una interpretaci√≥n combinada de tu perfil psicom√©trico y emocional, basada en modelos de inteligencia artificial entrenados para este fin.</p>
        
        <h4>La experiencia consta de tres pasos:</h4>
        <ol>
          <li><strong>Test SD3:</strong> Complet√°s un cuestionario validado de 27 √≠tems que eval√∫a maquiavelismo, narcisismo y psicopat√≠a subcl√≠nica.</li>
          <li><strong>An√°lisis de microexpresiones:</strong> Sub√≠s una imagen facial que ser√° procesada por un modelo entrenado para detectar emociones sutiles.</li>
          <li><strong>Interpretaci√≥n combinada:</strong> Recib√≠s un resumen integrador de tus resultados psicom√©tricos y emocionales.</li>
        </ol>
        <p><em>Esta herramienta no reemplaza evaluaciones psicol√≥gicas profesionales. Los resultados deben interpretarse como una aproximaci√≥n exploratoria dentro de un contexto acad√©mico.</em></p>
      </div>

      <form id="form-datos-basicos">
        <label>Nombre:</label>
        <input type="text" name="nombre" required>

        <label>Edad:</label>
        <input type="number" name="edad" min="18" max="100" required>

        <label>G√©nero:</label>
        <select name="genero" required>
          <option value="">Seleccionar</option>
          <option value="Femenino">Femenino</option>
          <option value="Masculino">Masculino</option>
          <option value="No binario">No binario</option>
          <option value="Prefiero no decirlo">Prefiero no decirlo</option>
        </select>

        <label>Pa√≠s:</label>
        <input type="text" name="pais" required>

        <label class="checkbox-label">
          <input type="checkbox" name="consentimiento" required>
          <span>
            Acepto prestar mis datos personales, los resultados del test y mi imagen facial para participar voluntariamente en esta investigaci√≥n acad√©mica. Entiendo que esta no es una evaluaci√≥n cl√≠nica, y que la informaci√≥n recopilada ser√° utilizada exclusivamente con fines de estudio, tratada de forma an√≥nima y almacenada en una base de datos privada sin posibilidad de identificarme personalmente.
          </span>
        </label>

        <button type="submit" class="btn-primary">Entiendo y deseo continuar</button>
      </form>
    </section>

    <!-- TEST SD3 -->
    <section class="section hidden" id="seccion-test">
      <h3>Paso 1: Test SD3</h3>
      <p style="text-align: center; margin-bottom: 30px; color: #667eea; font-size: 1.1em;">
        Indic√° tu nivel de acuerdo con cada afirmaci√≥n<br>
        <strong>1 = Fuertemente en desacuerdo</strong> | <strong>5 = Fuertemente de acuerdo</strong>
      </p>

      <form id="form-sd3"></form>

      <div id="resultado-sd3" class="hidden"></div>
      <div class="grafico-container hidden" id="grafico-container">
        <canvas id="grafico-sd3"></canvas>
      </div>
      <div id="narrativa-sd3" class="hidden"></div>

      <button id="btn-continuar-micro" class="hidden btn-primary">Continuar al an√°lisis facial</button>
    </section>

    <!-- MICROEXPRESIONES -->
    <section class="section hidden" id="seccion-micro">
      <h3>Paso 2: An√°lisis de Microexpresiones</h3>
      <p style="text-align: center; margin-bottom: 30px; color: #667eea; font-size: 1.1em;">
        Tom√° o sub√≠ una foto de tu rostro mirando a la c√°mara en un ambiente bien iluminado
      </p>

      <div class="camera-section">
        <video id="video" width="480" height="360" autoplay class="hidden"></video>
        <canvas id="canvas" width="480" height="360" class="hidden"></canvas>

        <div class="button-group" style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap; margin: 20px 0;">
          <button type="button" id="btn-activar-camara" class="btn-primary">üì∑ Activar c√°mara</button>
          <button type="button" id="btn-tomar-foto" class="hidden btn-primary">üì∏ Capturar foto</button>
          <button type="button" id="btn-subir-imagen" class="btn-primary">üìÅ Subir imagen</button>
        </div>
        <input type="file" id="input-imagen" accept="image/*">

        <button type="button" id="btn-analizar" class="hidden btn-primary" style="margin-top: 20px;">üß† Analizar microexpresiones</button>
      </div>

      <div id="resultado-micro" class="hidden"></div>
    </section>

    <!-- RESULTADO FINAL -->
    <section class="section hidden" id="seccion-final">
      <div class="resultado-final">
        <h3 style="text-align: center; font-size: 2em; color: #667eea; margin-bottom: 30px;">
          üéØ An√°lisis Integrado Final
        </h3>
        <div id="contenido-final"></div>
      </div>
    </section>
  </div>


  <script src="script.js"></script>
  

</body>
</html>
